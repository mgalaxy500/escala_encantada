<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Documento Automático</title>
</head>
<body style="text-align:center; font-family:Arial;">
  <h1>Documento Automático</h1>

  <iframe id="viewer" style="width:90vw; height:90vh; border:none;"></iframe>

  <script>
    // Quantidade total de documentos
    const totalDocs = 14;

    // Dias que avançam o documento: terça(2), quarta(3), quinta(4), sexta(5)
    const diasValidos = [2, 3, 4, 5];

    // Data de referência (deve ser uma segunda-feira)
    const dataBase = new Date(2025, 0, 6);

    const hoje = new Date();
    const diasPassados = Math.floor((hoje - dataBase) / (1000*60*60*24));

    let trocas = 0;

    // Conta quantas trocas (terças–sextas) já ocorreram
    for (let i = 0; i <= diasPassados; i++) {
      const d = new Date(dataBase);
      d.setDate(dataBase.getDate() + i);

      if (diasValidos.includes(d.getDay())) {
        trocas++;
      }
    }

    // Índice do documento atual
    const docIndex = (trocas % totalDocs) + 1;

    // Caminho do arquivo .docx
    const url = window.location.origin + "/docx/arquivo" + docIndex + ".docx";

    // Exibir o DOCX via Google Docs Viewer
    document.getElementById("viewer").src =
      "https://docs.google.com/gview?embedded=true&url=" + url;
  </script>
</body>
</html>
